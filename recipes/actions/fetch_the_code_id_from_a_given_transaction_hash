{
    "label": "others",
    "workflow": [
        {
            "step": 1,
            "label": "frontend",
            "introduction": "Step 1 defines a JavaScript helper that fetches the full transaction JSON from a public Juno LCD endpoint using only the native `fetch` API\u2014no external libraries required.",
            "code": "/* ------------------------------\n * fetchTxDetails.js\n * ------------------------------\n * Fetch the JSON representation of a Juno transaction by its hash.\n * --------------------------------*/\nexport const fetchTxDetails = async (\n  txHash,\n  lcdEndpoint = 'https://lcd-juno.cosmostation.io'\n) => {\n  try {\n    if (!txHash) throw new Error('txHash is required');\n\n    // gRPC-gateway path for tx lookup\n    const url = `${lcdEndpoint}/cosmos/tx/v1beta1/txs/${txHash}`;\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: { 'Content-Type': 'application/json' }\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch tx. HTTP ${response.status}`);\n    }\n\n    const data = await response.json();\n    return data; // full tx JSON\n  } catch (error) {\n    console.error('[fetchTxDetails] Error:', error);\n    throw error; // propagate so caller can handle\n  }\n};",
            "usage": "import { fetchTxDetails } from './fetchTxDetails';\n\nconst txHash = '38330E909CD219B80927009DA37FD69D334D19B2AD4EC47456A24E85034F0085';\nconst txData = await fetchTxDetails(txHash);\nconsole.log('Raw tx JSON:', txData);"
        },
        {
            "step": 2,
            "label": "frontend",
            "introduction": "Step 2 provides a lightweight parser that walks the transaction logs/events, decodes base-64 attributes, and returns the numeric `code_id`.",
            "code": "/* ------------------------------\n * parseCodeIdFromTx.js\n * ------------------------------\n * Extracts `code_id` from a tx JSON returned by Step 1.\n * --------------------------------*/\nexport const parseCodeIdFromTx = (txJson) => {\n  if (!txJson?.tx_response?.logs) {\n    throw new Error('Invalid transaction JSON: logs field missing');\n  }\n\n  // Helper to safely decode base64 in both browser & Node runtimes\n  const b64decode = (b64) => {\n    try {\n      return atob(b64);\n    } catch (_) {\n      return Buffer.from(b64, 'base64').toString('utf-8');\n    }\n  };\n\n  for (const log of txJson.tx_response.logs) {\n    for (const event of log.events || []) {\n      for (const attr of event.attributes || []) {\n        const key = b64decode(attr.key);\n        if (key === 'code_id') {\n          const value = b64decode(attr.value);\n          const codeIdNum = Number(value);\n          if (Number.isNaN(codeIdNum)) {\n            throw new Error(`code_id value is not a number: ${value}`);\n          }\n          return codeIdNum;\n        }\n      }\n    }\n  }\n\n  throw new Error('code_id attribute not found in transaction');\n};",
            "usage": "import { parseCodeIdFromTx } from './parseCodeIdFromTx';\n\nconst codeId = parseCodeIdFromTx(txData);\nconsole.log('Extracted code_id:', codeId);"
        }
    ]
}