{
    "label": "query_contract",
    "workflow": [
        {
            "step": 1,
            "label": "frontend",
            "introduction": "Step 1 defines a small helper that takes a JavaScript object and returns a canonically-serialized JSON string with no extra whitespace; ideal for Cosmos WASM contract query payloads.",
            "code": "export const serializeJson = (payload) => {\n  /*\n   * Recursively sort object keys to achieve a deterministic\n   * (canonical) JSON representation, then stringify with no spaces.\n   */\n  const canonicalize = (value) => {\n    if (value === null || typeof value !== 'object') return value;\n    if (Array.isArray(value)) return value.map(canonicalize);\n    const sortedKeys = Object.keys(value).sort();\n    const result = {};\n    for (const key of sortedKeys) {\n      result[key] = canonicalize(value[key]);\n    }\n    return result;\n  };\n\n  try {\n    const canonicalPayload = canonicalize(payload);\n    return JSON.stringify(canonicalPayload);\n  } catch (error) {\n    console.error('serializeJson error:', error);\n    throw new Error(`Could not serialize payload: ${error.message}`);\n  }\n};",
            "usage": "const jsonString = serializeJson({ all_tokens: {} }); // => \"{\\\"all_tokens\\\":{}}\""
        },
        {
            "step": 2,
            "label": "frontend",
            "introduction": "Step 2 base64-encodes the canonical JSON string produced in Step 1 so it can be supplied to Cosmos query endpoints that expect base64-encoded binary data.",
            "code": "export const encodeBase64 = (input) => {\n  try {\n    // In browsers `btoa` is available; in Node.js use Buffer as fallback.\n    if (typeof btoa === 'function') {\n      return btoa(input);\n    }\n    return Buffer.from(input, 'utf8').toString('base64');\n  } catch (error) {\n    console.error('encodeBase64 error:', error);\n    throw new Error(`Could not base64-encode string: ${error.message}`);\n  }\n};",
            "usage": "const base64Payload = encodeBase64(jsonString); // => \"eyJhbGxfdG9rZW5zIjp7fX0=\""
        }
    ]
}