{
    "label": "others",
    "workflow": [
        {
            "step": 1,
            "label": "frontend",
            "introduction": "Collect user inputs (deployer address, salt, and init-code hash) and forward them to a backend endpoint that performs the CREATE2 calculation.",
            "code": "/*\n * getCreate2Address()\n * Prompts the user for the required parameters and calls the backend\n * FastAPI endpoint `/api/compute_create2_address`.\n */\nexport const getCreate2Address = async () => {\n  try {\n    // Prompt the user for the three required parameters\n    const deployer = prompt(\"Enter the deployer (factory) address (0x\u2026)\");\n    const salt = prompt(\"Enter the 32-byte salt in hex (WITHOUT 0x)\");\n    const initCodeHash = prompt(\"Enter the contract init-code hash (0x\u2026)\");\n\n    // Basic client-side validation\n    if (!deployer || !salt || !initCodeHash) {\n      throw new Error(\"All three fields are required.\");\n    }\n\n    // Send the data to the backend for processing\n    const res = await fetch(\"/api/compute_create2_address\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        deployer,\n        salt,\n        init_code_hash: initCodeHash\n      })\n    });\n\n    if (!res.ok) {\n      // Surface backend error message, if any\n      const err = await res.json();\n      throw new Error(err.detail || \"Backend error while computing address.\");\n    }\n\n    const { create2_address } = await res.json();\n    alert(`Deterministic CREATE2 address: ${create2_address}`);\n    return create2_address;\n  } catch (error) {\n    console.error(error);\n    alert(error.message);\n    return null;\n  }\n};",
            "usage": "const deterministicAddress = await getCreate2Address();"
        },
        {
            "step": 2,
            "label": "backend",
            "introduction": "Provide a FastAPI endpoint that deterministically derives a CREATE2 address from the provided deployer, salt, and init-code hash.",
            "code": "from fastapi import FastAPI, HTTPException\nfrom pydantic import BaseModel, Field\nfrom eth_utils import keccak, to_checksum_address\n\napp = FastAPI()\n\nclass Create2Request(BaseModel):\n    deployer: str = Field(..., description=\"0x-prefixed deployer (factory) address\")\n    salt: str = Field(..., description=\"32-byte hex string WITHOUT 0x prefix\")\n    init_code_hash: str = Field(..., description=\"0x-prefixed keccak256 hash of the contract's init code\")\n\ndef _strip_0x(hex_str: str) -> str:\n    \"\"\"Remove 0x prefix, if present.\"\"\"\n    return hex_str[2:] if hex_str.startswith(\"0x\") else hex_str\n\ndef _hex_to_bytes(hex_str: str, expected_len: int) -> bytes:\n    \"\"\"Convert hex to bytes, validating exact length.\"\"\"\n    hex_str = _strip_0x(hex_str)\n    if len(hex_str) != expected_len:\n        raise ValueError(f\"Expected {expected_len} hex chars, got {len(hex_str)}.\")\n    return bytes.fromhex(hex_str)\n\n@app.post(\"/api/compute_create2_address\")\nasync def compute_create2_address(req: Create2Request):\n    try:\n        deployer_bytes = _hex_to_bytes(req.deployer, 40)   # 20 bytes\n        salt_bytes = _hex_to_bytes(req.salt, 64)           # 32 bytes\n        init_code_hash_bytes = _hex_to_bytes(req.init_code_hash, 64)  # 32 bytes\n    except ValueError as err:\n        raise HTTPException(status_code=400, detail=str(err))\n\n    # CREATE2 formula: keccak256(0xff ++ deployer ++ salt ++ initCodeHash)[12:]\n    data = b\"\\xff\" + deployer_bytes + salt_bytes + init_code_hash_bytes\n    derived = keccak(data)[12:]  # Take the right-most 20 bytes\n    checksum_addr = to_checksum_address(\"0x\" + derived.hex())\n\n    return {\"create2_address\": checksum_addr}",
            "usage": "POST the JSON payload {\"deployer\": \"0x\u2026\", \"salt\": \"\u2026\", \"init_code_hash\": \"0x\u2026\"} to /api/compute_create2_address.  The endpoint returns {\"create2_address\": \"0x\u2026\"}."
        }
    ]
}